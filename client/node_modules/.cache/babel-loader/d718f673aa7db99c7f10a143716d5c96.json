{"ast":null,"code":"import _classCallCheck from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/amayas/Projects/versy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/amayas/Projects/versy/src/components/message/Message.js\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport React from \"react\";\nimport MessageAvatar from \"./MessageAvatar\";\nimport MessageContent from \"./MessageContent\";\nimport MessageActions from \"./MessageActions\";\nimport MessageHeader from \"./MessageHeader\";\nimport MessageAction from \"./MessageAction\";\nimport MessageViewContainer from \"../containers/MessageViewContainer\";\nimport Popup from \"reactjs-popup\";\nimport MessageLikes from \"./MessageLikes\";\nimport { getUser } from \"../../data/data\";\nimport Icon from \"../Icon\";\nimport getCookie from \"../../utils/Cookies\";\nimport AuthentificationLayout from \"../../layouts/AuthentificationLayout\";\n\nvar Message = /*#__PURE__*/function (_React$Component) {\n  _inherits(Message, _React$Component);\n\n  function Message(props) {\n    var _this;\n\n    _classCallCheck(this, Message);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Message).call(this, props));\n    _this.state = {\n      refresh: false\n    };\n    _this.toggleLike = _this.toggleLike.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Message, [{\n    key: \"toggleLike\",\n    value: function toggleLike(user) {\n      var likes = this.state.likes;\n      if (likes.find(function (u) {\n        return u.id === user.id;\n      })) likes.splice(likes.indexOf(user), 1);else likes.push(user);\n      this.setState({\n        refresh: !this.state.refresh\n      }); // Todo push to server\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var likes = [];\n\n      var _iterator = _createForOfIteratorHelper(this.props.data.likes),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var i = _step.value;\n          likes.push(getUser(i));\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var token = getCookie(\"token\");\n      var user = getUser(token);\n      var isLiked = user ? this.state.likes.find(function (u) {\n        return u.id === user.id;\n      }) : false;\n      var style = {\n        width: \"700px\",\n        height: \"600px\",\n        overflowY: \"scroll\",\n        borderRadius: \"30px\",\n        border: \"1px solid #f3f4f6\",\n        backgroundColor: \"#111827\"\n      };\n      return /*#__PURE__*/React.createElement(\"article\", {\n        className: \"message\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(MessageAvatar, {\n        user: this.props.data.user,\n        setMainContainer: this.props.setMainContainer,\n        setPage: this.props.setPage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(MessageHeader, {\n        message: this.props.data,\n        setMainContainer: this.props.setMainContainer,\n        setPage: this.props.setPage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(MessageContent, {\n        message: this.props.data,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(MessageActions, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 9\n        }\n      }, this.props.data.isComment || /*#__PURE__*/React.createElement(MessageAction, {\n        name: \"fa-comment\",\n        list: this.props.data.comments,\n        onClick: function onClick() {\n          _this2.props.setMainContainer( /*#__PURE__*/React.createElement(MessageViewContainer, {\n            message: _this2.props.data,\n            setMainContainer: _this2.props.setMainContainer,\n            setPage: _this2.props.setPage,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 19\n            }\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"message-action\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Icon, {\n        name: \"fa-heart\",\n        size: \"fa-xl\",\n        effect: isLiked && \"liked\",\n        onClick: function onClick() {\n          if (token) {\n            _this2.toggleLike(user);\n\n            return;\n          }\n\n          _this2.props.setPage( /*#__PURE__*/React.createElement(AuthentificationLayout, {\n            setPage: _this2.props.setPage,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 19\n            }\n          }));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(Popup, {\n        trigger: /*#__PURE__*/React.createElement(\"span\", {\n          className: \"message-action-text\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 17\n          }\n        }, this.state.likes.length),\n        contentStyle: style,\n        modal: true,\n        closeOnDocumentClick: true,\n        closeOnEscape: true,\n        lockScroll: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }\n      }, function (close) {\n        return /*#__PURE__*/React.createElement(MessageLikes, {\n          likes: _this2.state.likes,\n          setMainContainer: _this2.props.setMainContainer,\n          setPage: _this2.props.setPage,\n          close: close,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 17\n          }\n        });\n      }))));\n    }\n  }]);\n\n  return Message;\n}(React.Component);\n\nexport default Message;","map":{"version":3,"sources":["/home/amayas/Projects/versy/src/components/message/Message.js"],"names":["React","MessageAvatar","MessageContent","MessageActions","MessageHeader","MessageAction","MessageViewContainer","Popup","MessageLikes","getUser","Icon","getCookie","AuthentificationLayout","Message","props","state","refresh","toggleLike","bind","user","likes","find","u","id","splice","indexOf","push","setState","data","i","token","isLiked","style","width","height","overflowY","borderRadius","border","backgroundColor","setMainContainer","setPage","isComment","comments","length","close","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport MessageAvatar from \"./MessageAvatar\";\nimport MessageContent from \"./MessageContent\";\nimport MessageActions from \"./MessageActions\";\nimport MessageHeader from \"./MessageHeader\";\nimport MessageAction from \"./MessageAction\";\nimport MessageViewContainer from \"../containers/MessageViewContainer\";\nimport Popup from \"reactjs-popup\";\nimport MessageLikes from \"./MessageLikes\";\nimport { getUser } from \"../../data/data\";\nimport Icon from \"../Icon\";\nimport getCookie from \"../../utils/Cookies\";\nimport AuthentificationLayout from \"../../layouts/AuthentificationLayout\";\nclass Message extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      refresh: false,\n    };\n\n    this.toggleLike = this.toggleLike.bind(this);\n  }\n\n  toggleLike(user) {\n    const likes = this.state.likes;\n\n    if (likes.find((u) => u.id === user.id))\n      likes.splice(likes.indexOf(user), 1);\n    else likes.push(user);\n\n    this.setState({ refresh: !this.state.refresh });\n\n    // Todo push to server\n  }\n\n  render() {\n    let likes = [];\n    for (const i of this.props.data.likes) likes.push(getUser(i));\n\n    const token = getCookie(\"token\");\n    const user = getUser(token);\n    const isLiked = user\n      ? this.state.likes.find((u) => u.id === user.id)\n      : false;\n\n    const style = {\n      width: \"700px\",\n      height: \"600px\",\n      overflowY: \"scroll\",\n      borderRadius: \"30px\",\n      border: \"1px solid #f3f4f6\",\n      backgroundColor: \"#111827\",\n    };\n\n    return (\n      <article className=\"message\">\n        <MessageAvatar\n          user={this.props.data.user}\n          setMainContainer={this.props.setMainContainer}\n          setPage={this.props.setPage}\n        />\n        <MessageHeader\n          message={this.props.data}\n          setMainContainer={this.props.setMainContainer}\n          setPage={this.props.setPage}\n        />\n        <MessageContent message={this.props.data} />\n        <MessageActions>\n          {this.props.data.isComment || (\n            <MessageAction\n              name=\"fa-comment\"\n              list={this.props.data.comments}\n              onClick={() => {\n                this.props.setMainContainer(\n                  <MessageViewContainer\n                    message={this.props.data}\n                    setMainContainer={this.props.setMainContainer}\n                    setPage={this.props.setPage}\n                  />\n                );\n              }}\n            />\n          )}\n\n          <span className=\"message-action\">\n            <Icon\n              name=\"fa-heart\"\n              size=\"fa-xl\"\n              effect={isLiked && \"liked\"}\n              onClick={() => {\n                if (token) {\n                  this.toggleLike(user);\n                  return;\n                }\n\n                this.props.setPage(\n                  <AuthentificationLayout setPage={this.props.setPage} />\n                );\n              }}\n            />\n\n            <Popup\n              trigger={\n                <span className=\"message-action-text\">\n                  {this.state.likes.length}\n                </span>\n              }\n              contentStyle={style}\n              modal\n              closeOnDocumentClick\n              closeOnEscape\n              lockScroll={true}\n            >\n              {(close) => (\n                <MessageLikes\n                  likes={this.state.likes}\n                  setMainContainer={this.props.setMainContainer}\n                  setPage={this.props.setPage}\n                  close={close}\n                />\n              )}\n            </Popup>\n          </span>\n        </MessageActions>\n      </article>\n    );\n  }\n}\n\nexport default Message;\n"]},"metadata":{},"sourceType":"module"}